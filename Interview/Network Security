##Faulty Firewall

Suppose you have a firewall that's supposed to block SSH connections, but instead lets them through. How would you debug it? 

Within the last project, there were multiple virtual machines that were contained within a security group. The security group by default did not allow SSH connections. I added SSH connections through my specific IP address to access the Jumpbox gateway which was the only virtual machine that could access the other machines on the network. This was added so that Docker and Ansible could be installed on to the Jumpbox. In turn, I was able to install Docker containers into the other machines. However, if there was attempted SSH traffic to the Web1, Web2, or ELK server machines, the connection would not be successful. The only public access is through the Jumpbox machine due to the security rules set in place. 

If another one of the virtual machines was accepting SSH connections, I would assume that it was human error within one of the network security group rules. First, turning on the Jumpbox and the virtual machine through the Virtual Machine tab in the Azure Portal and checking the virtual machine that was accessed through a SSH connection. When the machine is accessed, I would nano the ssh_config file to check if an SSH connection is allowed. After, I would check all inbound rules within the Network Security Group to ensure that none of the rules permit public access through the same port used to access the virtual machine. To verify that the rules are set properly, I would attempt to create a connection with the virtual machine. If it still creates a connection, I would check that the virtual machine is running correctly by checking the status with systemctl. If all rules are correct and the SSH daemon is running without error, then I would check if the system is running its own firewall. If so, I would disable the firewall to ensure that only the security group rules are valid.  

With this system, the Project 1 network isnâ€™t immune to unauthorized access. By using this network setup, any attacks or unauthorized can be isolated and monitored easier. Overall, the surface area for attack is reduced. 
